(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{449:function(s,t,e){"use strict";e.r(t);var a=e(19),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"node-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-js"}},[s._v("#")]),s._v(" Node.js")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://www.typescripttutorial.net/typescript-tutorial/nodejs-typescript/",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文地址"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("在本教程中，你将学习搭建使用 TypeScript 语言的 Node.js 项目的自动化开发环境。")]),s._v(" "),e("blockquote",[e("p",[s._v("本教程假设你在系统上已经安装 Node.js 和 tsc 模块。")])]),s._v(" "),e("h3",{attrs:{id:"创建目录结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建目录结构"}},[s._v("#")]),s._v(" 创建目录结构")]),s._v(" "),e("p",[s._v("首先创建一个新的目录 "),e("code",[s._v("nodets")]),s._v("。")]),s._v(" "),e("p",[s._v("接下来，在 "),e("code",[s._v("nodets")]),s._v(" 目录下面创建两个子目录，分别是 "),e("code",[s._v("build")]),s._v(" 和 "),e("code",[s._v("src")]),s._v("，如下所示：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/cody1991/images@master/typescript-tutorial/nodejs-typescript-directory-structure.4buzjj0j3lc0.png",alt:"nodejs-typescript-directory-structure"}})]),s._v(" "),e("p",[s._v("TypeScript 代码存储在 "),e("code",[s._v("src")]),s._v(" 目录下，而编译器的输出文件存储在 "),e("code",[s._v("build")]),s._v(" 目录中。")]),s._v(" "),e("h3",{attrs:{id:"配置-typescript-编译器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-typescript-编译器"}},[s._v("#")]),s._v(" 配置 TypeScript 编译器")]),s._v(" "),e("p",[s._v("打开 macOS 和 Linux 的终端或者 Windows 上的命令提示符，在 "),e("code",[s._v("nodets")]),s._v(" 目录下运行下面的命令，创建 "),e("code",[s._v("tsconfig.json")]),s._v(" 文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("tsc --init\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("你会看到 "),e("code",[s._v("nodets")]),s._v(" 目录下新增了 "),e("code",[s._v("tsconfig.json")]),s._v(" 文件：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/cody1991/images@master/typescript-tutorial/nodejs-typescript-tsconfig.json_.jn33hl2u37k.png",alt:"nodejs-typescript-tsconfig.json"}})]),s._v(" "),e("p",[e("code",[s._v("tsconfig.json")]),s._v(" 配置指定目录 ("),e("code",[s._v("nodets")]),s._v(") 是 TypeScript 项目的根目录。当你编译 TypeScript 文件的时候，TypeScript 编译器会使用 "),e("code",[s._v("tsconfig.json")]),s._v(" 中的配置来编译项目。")]),s._v(" "),e("p",[s._v("现在，你可以打开 "),e("code",[s._v("tsconfig.json")]),s._v(" 文件，里面有非常多的选项，在本教程中，主要关注两个选项：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("rootdir")]),s._v(" – 指定 TypeScript 输入文件的根目录")]),s._v(" "),e("li",[e("code",[s._v("outdir")]),s._v(" - 指定 JavaScript 输出文件的目录")])]),s._v(" "),e("p",[s._v("这些选项在默认情况下是被注释掉的，你需要取消它们的注释（删除行首的 "),e("code",[s._v("//")]),s._v("），并改成如下所示的配置：")]),s._v(" "),e("p",[s._v("对于 "),e("code",[s._v("outDir")]),s._v(" 选项：")]),s._v(" "),e("div",{staticClass:"language-ts line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ts"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"outDir"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./build"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("对于 "),e("code",[s._v("rootDir")]),s._v(" 选项：")]),s._v(" "),e("div",{staticClass:"language-ts line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ts"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rootDir"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("为了验证新的配置是否生效，可以在 "),e("code",[s._v("./src")]),s._v(" 目录下创建一个名为 "),e("code",[s._v("app.ts")]),s._v(" 的新文件，敲入如下代码：")]),s._v(" "),e("div",{staticClass:"language-ts line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ts"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Node.js TypeScript'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/cody1991/images@master/typescript-tutorial/nodejs-typescript-app.ts_.6j9le5sytxs0.png",alt:"nodejs-typescript-app"}})]),s._v(" "),e("p",[s._v("接下来运行下面的命令来执行 TypeScript 编译器的编译工作，它会编译所有存储在 "),e("code",[s._v("src")]),s._v(" 目录下的文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("tsc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果配置是正确有效的，将会看到 "),e("code",[s._v("./build")]),s._v(" 目录下生成了 "),e("code",[s._v("app.js")]),s._v(" 文件：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/cody1991/images@master/typescript-tutorial/nodejs-typescript-app.js.4okqve6avca0.png",alt:"nodejs-typescript-app"}})]),s._v(" "),e("p",[s._v("导航到 "),e("code",[s._v("build")]),s._v(" 目录并执行下面的命令来运行 "),e("code",[s._v("app.js")]),s._v(" 文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("node app.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("看到下面的输出结果：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("Node.js TypeScript\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("每当你修改了 TypeScript 代码的时候，你需要：")]),s._v(" "),e("ul",[e("li",[s._v("构建项目；")]),s._v(" "),e("li",[s._v("运行 JavaScript 输出文件。")])]),s._v(" "),e("p",[s._v("这样很浪费时间。幸运的是，你可以使用一些 Node.js 模块，自动化执行上面的流程。")]),s._v(" "),e("h3",{attrs:{id:"安装-node-js-模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装-node-js-模块"}},[s._v("#")]),s._v(" 安装 Node.js 模块")]),s._v(" "),e("p",[e("code",[s._v("nodemon")]),s._v(" 模块允许你在修改了 JavaScript 源代码后，重新启动应用程序。")]),s._v(" "),e("p",[e("code",[s._v("concurrently")]),s._v(" 模块允许并发运行多个命令。")]),s._v(" "),e("p",[s._v("首先在根目录下执行 "),e("code",[s._v("npm init")]),s._v(" 命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init --yes\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("接下来，安装 "),e("code",[s._v("nodemon")]),s._v(" 和 "),e("code",[s._v("concurrently")]),s._v(" 模块：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --g nodemon concurrently\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("需要花费一点时间来安装它们，安装完成以后我们继续后面的步骤。")]),s._v(" "),e("p",[s._v("注意 "),e("code",[s._v("--g")]),s._v(" 标识表示 npm 将会全局安装这两个模块，你可以在其他项目中使用它们。")]),s._v(" "),e("p",[s._v("接下来打开 "),e("code",[s._v("package.json")]),s._v(" 文件，在 "),e("code",[s._v("scripts")]),s._v(" 选项中会看到下面的代码：")]),s._v(" "),e("div",{staticClass:"language-json line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[s._v("...\n"),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\"Error: no test specified\\" && exit 1"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n...\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("把 "),e("code",[s._v("scripts")]),s._v(" 修改成如下所示的配置：")]),s._v(" "),e("div",{staticClass:"language-json line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[s._v("...\n"),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start:build"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tsc -w"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start:run"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nodemon build/app.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"concurrently npm:start:*"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n...\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[e("code",[s._v('"start:build": "tsc -w"')]),s._v(" 会监听 "),e("code",[s._v("./src")]),s._v(" 下的文件的变化，当有文件发生变化的时候，重新编译这些文件。")]),s._v(" "),e("p",[e("code",[s._v('"start:run": "nodemon build/app.js"')]),s._v(" 每当有新文件产生的时候，重新运行 "),e("code",[s._v("./build")]),s._v(" 目录下的 "),e("code",[s._v("app.js")]),s._v(" 文件。")]),s._v(" "),e("p",[e("code",[s._v('"start": "concurrently npm:start:*"')]),s._v(" 运行所有 "),e("code",[s._v("npm:start:*")]),s._v(" 开头的命令，它会执行上面的 "),e("code",[s._v("start:build")]),s._v(" 和 "),e("code",[s._v("start:run")]),s._v(" 命令。")]),s._v(" "),e("p",[s._v("因为 "),e("code",[s._v("app.js")]),s._v(" 是 Node.js 程序的入口，还需要把 "),e("code",[s._v("package.json")]),s._v(" 文件中的 "),e("code",[s._v("main")]),s._v(" 配置修改成 "),e("code",[s._v("app.js")]),s._v("，如下所示：")]),s._v(" "),e("div",{staticClass:"language-ts line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ts"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.js"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("修改成：")]),s._v(" "),e("div",{staticClass:"language-ts line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ts"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app.js"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("最后，运行下面的命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("为了验证配置已经生效，修改一些 "),e("code",[s._v("app.ts")]),s._v(" 中的代码，将会在控制台看到一些新的执行结果输出。")])])}),[],!1,null,null,null);t.default=n.exports}}]);